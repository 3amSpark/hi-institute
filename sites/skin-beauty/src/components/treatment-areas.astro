---
import Heading from "@repo/ui/components/heading.astro";
import FadeIn from "@repo/ui/components/fade-in.astro";
import ArrowRight from "@repo/ui/icons/arrow-right.astro";

const categories = [
  {
    id: "cara",
    label: "Cara y Cuello",
    areas: [
      { name: "Patillas", price: "Q150", icon: "ğŸ‘¤" },
      { name: "Barbilla", price: "Q125", icon: "ğŸ‘¤" },
      { name: "Bigote", price: "Q125", icon: "ğŸ‘¤" },
      { name: "Orejas", price: "Q150", icon: "ğŸ‘‚" },
      { name: "Nuca", price: "Q200", icon: "ğŸ‘¤" },
      { name: "Delineado de barba", price: "Q250", icon: "ğŸ§”" },
      { name: "Rostro completo", price: "Q550", icon: "ğŸ‘¤" },
      { name: "Explorar otras Ãreas", price: "Consultar", icon: "âœ¨" },
    ],
  },
  {
    id: "superior",
    label: "Parte superior del cuerpo",
    areas: [
      { name: "Axilas", price: "Q250", icon: "ğŸ‘•" },
      { name: "Brazos completos", price: "Q650", icon: "ğŸ’ª" },
      { name: "Medios brazos", price: "Q400", icon: "ğŸ’ª" },
      { name: "Hombros", price: "Q350", icon: "ğŸ‘•" },
      { name: "Espalda completa", price: "Q850", icon: "ğŸ‘•" },
      { name: "Media espalda", price: "Q500", icon: "ğŸ‘•" },
      { name: "Pecho", price: "Q600", icon: "ğŸ‘•" },
      { name: "Abdomen", price: "Q500", icon: "ğŸ‘•" },
    ],
  },
  {
    id: "inferior",
    label: "Parte inferior del cuerpo",
    areas: [
      { name: "Piernas completas", price: "Q950", icon: "ğŸ¦µ" },
      { name: "Medias piernas", price: "Q600", icon: "ğŸ¦µ" },
      { name: "GlÃºteos", price: "Q450", icon: "ğŸ¦µ" },
      { name: "LÃ­nea de bikini", price: "Q350", icon: "ğŸ‘™" },
      { name: "Bikini completo", price: "Q650", icon: "ğŸ‘™" },
    ],
  },
  {
    id: "completas",
    label: "Ãreas completas",
    areas: [
      { name: "Cuerpo completo (Mujer)", price: "Q2,500", icon: "âœ¨" },
      { name: "Cuerpo completo (Hombre)", price: "Q3,200", icon: "âœ¨" },
    ],
  },
];
---

<section class="mx-auto max-w-7xl px-4 py-20">
  <div class="mb-12 text-center">
    <Heading
      level={2}
      className="text-brand-gray mb-4 font-medium"
      text="Ãreas de tratamiento Unisex"
    />
    <p class="text-brand-gray/70 mx-auto max-w-2xl font-heading text-lg leading-relaxed">
      EscrÃ­benos para conocer nuestras promociones y descuentos por tratamiento
      en mÃºltiples Ã¡reas.
    </p>
  </div>

  <!-- Tabs -->
  <div class="mb-12 overflow-x-auto pb-4">
    <div
      class="flex min-w-max justify-center border-b border-gray-100 px-4"
      id="treatment-tabs"
    >
      {
        categories.map((cat, i) => (
          <button
            class:list={[
              "font-heading relative px-6 py-4 text-sm font-medium transition-all duration-300",
              i === 0
                ? "text-brand border-brand border-b-2"
                : "text-brand-gray/50 hover:text-brand-gray border-b-2 border-transparent",
            ]}
            data-tab={cat.id}
          >
            {cat.label}
          </button>
        ))
      }
    </div>
  </div>

  <!-- Areas Grid -->
  <div class="relative min-h-[400px]">
    {
      categories.map((cat, i) => (
        <div
          id={`grid-${cat.id}`}
          class:list={[
            "grid grid-cols-2 gap-4 transition-all duration-500 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5",
            i !== 0 && "absolute inset-0 pointer-events-none opacity-0 translate-y-4",
          ]}
        >
          {cat.areas.map((area, areaIdx) => (
            <FadeIn duration={0.5} delay={areaIdx * 0.05} class="h-full">
              <div class="group bg-brand/10 relative flex aspect-3/4 cursor-pointer flex-col items-center justify-center overflow-hidden rounded-2xl p-6 transition-all duration-500 hover:scale-[1.02]">
                <!-- Icon Placeholder -->
                <div class="mb-6 flex size-20 items-center justify-center rounded-full bg-white/50 text-4xl transition-transform duration-500 group-hover:scale-110">
                  {area.icon}
                </div>

                <!-- Name -->
                <span class="font-heading text-brand-gray text-center text-lg font-medium transition-opacity duration-300 group-hover:opacity-0">
                  {area.name}
                </span>

                <!-- Price Overlay -->
                <div class="absolute inset-0 flex flex-col items-center justify-center bg-white/95 px-4 text-center opacity-0 backdrop-blur-md transition-all duration-500 group-hover:opacity-100">
                  <div class="translate-y-4 transition-transform duration-500 group-hover:-translate-y-4">
                    <span class="text-brand-gray/60 block text-[10px] font-bold uppercase tracking-widest">
                      Precio desde
                    </span>
                    <span class="text-brand-gray font-heading mt-1 block text-2xl font-bold">
                      {area.price}
                    </span>
                  </div>

                  <div class="absolute bottom-8 left-0 right-0 flex translate-y-4 justify-center opacity-0 transition-all delay-75 duration-500 group-hover:translate-y-0 group-hover:opacity-100">
                    <div class="bg-brand/10 text-brand flex items-center gap-2 rounded-full px-4 py-2 text-[11px] font-bold uppercase tracking-widest transition-colors hover:bg-brand hover:text-white">
                      Agendar cita
                      <ArrowRight class="size-3" />
                    </div>
                  </div>
                </div>
              </div>
            </FadeIn>
          ))}
        </div>
      ))
    }
  </div>
</section>

<script>
  function setupTabs() {
    const tabButtons = document.querySelectorAll("[data-tab]");
    const grids = document.querySelectorAll('[id^="grid-"]');

    tabButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const targetId = button.getAttribute("data-tab");

        // Update buttons
        tabButtons.forEach((btn) => {
          btn.classList.remove("text-brand", "border-brand");
          btn.classList.add("text-brand-gray/50", "border-transparent");
        });
        button.classList.add("text-brand", "border-brand");
        button.classList.remove("text-brand-gray/50", "border-transparent");

        // Update grids
        grids.forEach((grid) => {
          if (grid.id === `grid-${targetId}`) {
            grid.classList.remove(
              "absolute",
              "inset-0",
              "pointer-events-none",
              "opacity-0",
              "translate-y-4"
            );
          } else {
            grid.classList.add(
              "absolute",
              "inset-0",
              "pointer-events-none",
              "opacity-0",
              "translate-y-4"
            );
          }
        });
      });
    });
  }

  // Run on load
  setupTabs();

  // Run on view transition if enabled
  document.addEventListener("astro:after-swap", setupTabs);
</script>

