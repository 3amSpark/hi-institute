---
import RootLayout from "../layouts/root.astro";
import Heading from "@repo/ui/components/heading.astro";
import FadeIn from "@repo/ui/components/fade-in.astro";
---

<RootLayout>
  <section
    class="w-full bg-black overflow-hidden h-dvh relative flex flex-col items-center justify-center thingy"
  >
    <div class="flex flex-col gap-4 self-center z-10 max-w-5xl">
      <FadeIn duration={1}>
        <Heading
          text="Cuidamos tu salud íntima con precisión y ciencia."
          className="text-white text-balance text-shadow-sm "
          level={1}
        />
      </FadeIn>
      <div class="flex gap-4">
        <FadeIn duration={1} delay={0.1}>
          <button
            class="bg-linear-to-r from-ziggurat to-smokey-pink text-white rounded-full py-2 uppercase font-heading px-6 group relative group overflow-hidden cursor-pointer"
          >
            <span class="invisible">Agenda tu cita ahora</span>
            <span
              class="absolute inset-0 flex items-center justify-center -translate-y-full group-hover:translate-y-0 transition-transform duration-300"
            >
              Agenda tu cita ahora
            </span>
            <span
              class="absolute inset-0 flex items-center justify-center translate-y-0 group-hover:translate-y-full transition-transform duration-300"
            >
              Agenda tu cita ahora
            </span>
          </button>
        </FadeIn>
      </div>
    </div>
    <picture>
      <source srcset="/hero-mobile.webp" media="(max-width: 799px)" />
      <source srcset="/hero-desktop.webp" media="(min-width: 800px)" />
      <img
        src="/hero-desktop.webp"
        alt="Cool hero"
        class="h-full w-full object-cover absolute inset-0 scale-130 image z-0"
      />
    </picture>
    <div class="absolute inset-0 bg-gradient-hero z-1"></div>
    <div class="absolute inset-0 bg-grain-hero z-2"></div>

    <!-- <div class="absolute inset-0 bg-black z-20 reveal-mask"></div> -->
  </section>

  <section
    class="text-white bg-eggshell text-5xl px-8 pt-20 flex flex-col gap-6 max-w-7xl mx-auto"
  >
    <FadeIn duration={1}>
      <Heading
        level={2}
        className="text-neutral-700 font-medium text-center"
        text="Cuidada. Precisa. Personal."
      />
      <Heading
        level={2}
        className="text-neutral-700 font-medium text-center"
        text="En Hi Fem Care redefinimos la salud de la mujer"
      />
    </FadeIn>
    <FadeIn duration={1} delay={0.1}>
      <p
        class="text-iroko/80 text-lg font-heading leading-relaxed text-center max-w-3/4 mx-auto"
      >
        Somos la única clínica creada exclusivamente para acompañar cada etapa
        de tu vida como mujer: tu bienestar hormonal, tu fertilidad, tu piso
        pélvico, tus cambios y los retos de la edad.
      </p>
    </FadeIn>
  </section>
  <section class="w-full mx-auto py-20 max-w-7xl">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 service-grid">
      {
        [
          {
            name: "Ginecología",
            image: "/ginecologia.webp",
          },
          {
            name: "Virus del Papiloma Humano",
            image: "/virus-pailoma-humano.webp",
          },
          {
            name: "Endometriosis",
            image: "/endometriosis.webp",
          },
          {
            name: "Uroginecología",
            image: "/uroginecologia.webp",
          },
          {
            name: "Fem Care Total",
            image: "/fem-care-total.webp",
          },
        ].map((service) => (
          <a
            href="#"
            class="relative group grid place-items-center aspect-square overflow-hidden cursor-pointer service rounded-sm"
          >
            <img
              src={service.image}
              alt={service.name}
              loading="lazy"
              class="absolute inset-0 w-full h-full object-cover"
            />
            <Heading
              level={4}
              className="text-white z-10 uppercase font-medium text-shadow-2xs"
              text={service.name}
            />
            <div class="translate-y-16 group-hover:translate-y-0 transition-transform duration-500 absolute bottom-4 left-1/2 -translate-x-1/2 z-10 flex items-center gap-2">
              <Heading
                level={5}
                className="text-white font-medium"
                text={"Ver más"}
              />
            </div>
          </a>
        ))
      }
    </div>
  </section>
  <footer>
    <div
      class="w-full text-center bg-radial-[at_0%_75%] from-ziggurat relative overflow-hidden to-smokey-pink py-20 bg-grain"
    >
      <div
        class="max-w-7xl flex flex-col gap-4 items-center justify-center mx-auto z-20 relative"
      >
        <FadeIn duration={1}>
          <Heading
            level={2}
            className="text-white text-balance text-shadow-sm"
            text="No tienes que tener todas las respuestas. Solo necesitas el primer paso."
          />
        </FadeIn>
        <FadeIn duration={1} delay={0.1}>
          <p class="text-white text-lg font-body">
            Tu bienestar íntimo empieza cuando te sientes acompañada. <br /> Agenda
            tu cita y da el primer paso hacia tu mejor versión.
          </p>
        </FadeIn>
        <FadeIn duration={1} delay={0.2}>
          <button
            class="bg-white text-ziggurat rounded-full py-2 uppercase font-heading px-6 group relative overflow-hidden cursor-pointer"
          >
            <span class="invisible">¡Agenda tu cita ahora!</span>
            <!-- Revealed text -->
            <span
              class="absolute inset-0 flex items-center justify-center -translate-y-full group-hover:translate-y-0 transition-transform duration-300 text-smokey-pink"
            >
              ¡Agenda tu cita ahora!
            </span>
            <!-- Initial text -->
            <span
              class="absolute inset-0 flex items-center justify-center translate-y-0 group-hover:translate-y-full transition-transform duration-300"
            >
              ¡Agenda tu cita ahora!
            </span>
          </button>
        </FadeIn>
      </div>
    </div>
    <div class="w-full text-center bg-white py-12">
      <div
        class="max-w-7xl flex flex-col gap-4 items-center justify-center mx-auto"
      >
        {
          [
            {
              day: "Lunes",
              start: "7:00 am",
              end: "4:00 pm",
            },
            {
              day: "Martes a Jueves",
              start: "6:30 am",
              end: "3:30 pm",
            },
            {
              day: "Viernes",
              start: "6:30 am",
              end: "2:30 pm",
            },
            {
              day: "Sábado",
              start: "7:00 am",
              end: "12:00 pm",
            },
          ].map((schedule) => (
            <div class="flex items-center flex-col font-heading text-brand-gray">
              <span class="font-semibold">{schedule.day}</span>
              <span class="font-light">
                {schedule.start} - {schedule.end}
              </span>
            </div>
          ))
        }
        <p class="text-brand-gray font-heading font-light">
          Avenida La Reforma 9-55, Edif. Reforma 10 <br /> Zona 10, 6to. nivel, Clínica
          606,<br />
          Ciudad de Guatemala, Guatemala
        </p>
      </div>
    </div>
  </footer>
</RootLayout>

<style>
  /* Local variables */
  :root {
    --grain-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 600'%3E%3Cfilter id='a'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23a)'/%3E%3C/svg%3E");
    --brand-gradient: linear-gradient(
      to top right,
      var(--color-ziggurat),
      var(--color-smokey-pink)
    );
  }

  /* Hero image parallax optimization */
  .image {
    will-change: transform;
    backface-visibility: hidden;
  }

  /* Service card grid */
  .service-grid {
    transition: opacity 0.7s var(--spring-easing);
  }

  .service-grid:hover .service {
    opacity: 0.65;
    scale: 0.955;
  }

  .service-grid .service:hover {
    opacity: 1;
    scale: 1;
    z-index: 3;
  }

  .service {
    transition:
      opacity var(--spring-duration) var(--spring-easing),
      scale 0.7s var(--spring-easing);
  }

  .service::before,
  .service::after {
    content: "";
    position: absolute;
    inset: 0;
  }

  .service::before {
    background: var(--brand-gradient);
    transform: scaleY(0);
    transform-origin: bottom;
    transition: transform var(--spring-duration) var(--spring-easing);
    z-index: 2;
  }

  .service:hover::before {
    transform: scaleY(1);
    transform-origin: top;
  }

  .service::after {
    background: linear-gradient(
      to top right,
      oklch(from var(--color-ziggurat) l c h / 0.65),
      oklch(from var(--color-smokey-pink) l c h / 0.65)
    );
    mix-blend-mode: multiply;
    z-index: 1;
  }

  /* Grain textures */
  .bg-grain::before,
  .bg-grain-hero {
    background-image: var(--grain-texture);
    background-repeat: repeat;
    background-size: 200px;
  }

  .bg-grain::before {
    content: "";
    position: absolute;
    inset: 0;
    opacity: 0.35;
    z-index: 1;
  }

  .bg-grain-hero {
    mix-blend-mode: overlay;
    opacity: 0.7;
    pointer-events: none;
  }

  .bg-gradient-hero {
    background: linear-gradient(
      to top right,
      oklch(from var(--color-ziggurat) l c h / 0.7),
      oklch(from var(--color-smokey-pink) l c h / 0.7)
    );
    mix-blend-mode: multiply;
    pointer-events: none;
  }
</style>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);

  // Hero image parallax - using force3D for GPU acceleration
  gsap.to(".image", {
    yPercent: -15,
    ease: "none",
    force3D: true,
    scrollTrigger: {
      trigger: ".thingy",
      start: "top top",
      end: "bottom top",
      scrub: 0.5, // slight smoothing reduces jank
    },
  });
</script>
