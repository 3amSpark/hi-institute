---
import RootLayout from "../layouts/root.astro";
import Heading from "@repo/ui/components/heading.astro";
import FadeIn from "@repo/ui/components/fade-in.astro";
import ArrowRight from "@repo/ui/icons/arrow-right.astro";
---

<RootLayout>
  <!-- Navbar -->
  <nav class="fixed top-0 left-0 right-0 z-50 bg-white/90 backdrop-blur-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-20">
        <!-- Logo -->
        <a href="/" class="shrink-0">
          <img src="/logo.svg" alt="Hi Fem Care" class="h-10 w-auto" />
        </a>

        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center gap-8">
          <a
            href="#ginecologia"
            class="text-brand-gray hover:text-smokey-pink transition-colors font-medium font-heading text-sm uppercase tracking-wide"
          >
            Ginecología
          </a>
          <a
            href="#vph"
            class="text-brand-gray hover:text-smokey-pink transition-colors font-medium font-heading text-sm uppercase tracking-wide"
          >
            VPH
          </a>
          <a
            href="#endometriosis"
            class="text-brand-gray hover:text-smokey-pink transition-colors font-medium font-heading text-sm uppercase tracking-wide"
          >
            Endometriosis
          </a>
          <a
            href="#uroginecologia"
            class="text-brand-gray hover:text-smokey-pink transition-colors font-medium font-heading text-sm uppercase tracking-wide"
          >
            Uroginecología
          </a>
          <a
            href="#femcare-total"
            class="text-brand-gray hover:text-smokey-pink transition-colors font-medium font-heading text-sm uppercase tracking-wide"
          >
            Femcare Total
          </a>
          <a
            href="#monalisa-touch"
            class="text-brand-gray hover:text-smokey-pink transition-colors font-medium font-heading text-sm uppercase tracking-wide"
          >
            Monalisa Touch
          </a>
        </div>

        <!-- Mobile Menu Button -->
        <button class="lg:hidden p-2" aria-label="Abrir menú">
          <svg
            class="w-6 h-6 text-iroko"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu (hidden by default) -->
    <div class="hidden lg:hidden">
      <div class="px-4 py-4 space-y-3 bg-white border-t border-gray-100">
        <a
          href="#ginecologia"
          class="block text-iroko hover:text-smokey-pink transition-colors font-heading text-sm uppercase tracking-wide"
        >
          Ginecología
        </a>
        <a
          href="#vph"
          class="block text-iroko hover:text-smokey-pink transition-colors font-heading text-sm uppercase tracking-wide"
        >
          VPH
        </a>
        <a
          href="#endometriosis"
          class="block text-iroko hover:text-smokey-pink transition-colors font-heading text-sm uppercase tracking-wide"
        >
          Endometriosis
        </a>
        <a
          href="#uroginecologia"
          class="block text-iroko hover:text-smokey-pink transition-colors font-heading text-sm uppercase tracking-wide"
        >
          Uroginecología
        </a>
        <a
          href="#femcare-total"
          class="block text-iroko hover:text-smokey-pink transition-colors font-heading text-sm uppercase tracking-wide"
        >
          Femcare Total
        </a>
        <a
          href="#monalisa-touch"
          class="block text-iroko hover:text-smokey-pink transition-colors font-heading text-sm uppercase tracking-wide"
        >
          Monalisa Touch
        </a>
      </div>
    </div>
  </nav>

  <section
    class="w-full bg-black overflow-hidden h-dvh relative flex flex-col items-center justify-center thingy"
  >
    <div class="flex flex-col gap-4 self-center z-10 max-w-5xl">
      <FadeIn duration={1}>
        <Heading
          text="Cuidamos tu salud íntima con precisión y ciencia."
          className="text-white text-balance text-shadow-sm "
          level={1}
        />
      </FadeIn>
      <div class="flex gap-4">
        <FadeIn duration={1} delay={0.1}>
          <button
            class="bg-radial-[at_50%_80%] border-t text-lg shadow-[inset_0px_-1px_1px_0px_rgba(255,255,255,0.4)] border-white/50 from-ziggurat to-smokey-pink text-white rounded-full py-2 uppercase font-heading px-7 group relative group overflow-hidden cursor-pointer"
          >
            <span class="invisible">Agenda tu cita ahora</span>
            <span
              class="absolute inset-0 flex items-center justify-center -translate-y-full group-hover:translate-y-0 transition-transform duration-300"
            >
              Agendar tu cita ahora
            </span>
            <span
              class="absolute inset-0 flex items-center justify-center translate-y-0 group-hover:translate-y-full transition-transform duration-300"
            >
              Agenda tu cita ahora
            </span>
          </button>
        </FadeIn>
      </div>
    </div>
    <picture>
      <source srcset="/hero-mobile.webp" media="(max-width: 799px)" />
      <source srcset="/hero-desktop.webp" media="(min-width: 800px)" />
      <img
        src="/hero-desktop.webp"
        alt="Cool hero"
        class="h-full w-full object-cover absolute inset-0 scale-130 parallax-image z-0"
      />
    </picture>
    <div class="absolute inset-0 bg-gradient-hero z-1"></div>
    <div class="absolute inset-0 bg-grain-hero z-2"></div>

    <div class="fixed inset-0 bg-black z-[100] reveal-mask pointer-events-none">
    </div>
    <div
      class="fixed inset-0 bg-smokey-pink z-[99] reveal-mask-2 pointer-events-none"
    >
    </div>
  </section>

  <section
    class="text-white bg-eggshell text-5xl px-8 pt-20 flex flex-col gap-6 max-w-7xl mx-auto"
  >
    <FadeIn duration={1}>
      <Heading
        level={2}
        className="text-neutral-700 font-medium text-xl sm:text-center"
        text="Cuidada. Precisa. Personal."
      />
      <Heading
        level={2}
        className="text-neutral-700 font-medium text-balance sm:text-center"
        text="En Hi Fem Care redefinimos la salud de la mujer"
      />
    </FadeIn>
    <FadeIn duration={1} delay={0.1}>
      <p
        class="text-iroko/80 text-lg font-heading leading-relaxed sm:text-center sm:max-w-3/4 mx-auto"
      >
        Somos la única clínica creada exclusivamente para acompañar cada etapa
        de tu vida como mujer: tu bienestar hormonal, tu fertilidad, tu piso
        pélvico, tus cambios y los retos de la edad.
      </p>
    </FadeIn>
  </section>
  <section class="w-full mx-auto py-20 max-w-7xl">
    <div class="flex flex-wrap gap-6 sm:gap-2 service-grid justify-center">
      {
        [
          {
            name: "Ginecología",
            image: "/ginecologia.webp",
          },
          {
            name: "Virus del Papiloma Humano",
            image: "/virus-pailoma-humano.webp",
          },
          {
            name: "Endometriosis",
            image: "/endometriosis.webp",
          },
          {
            name: "Uroginecología",
            image: "/uroginecologia.webp",
          },
          {
            name: "Fem Care Total",
            image: "/fem-care-total.webp",
          },
        ].map((service) => (
          <a
            href="#"
            class="relative group grid place-items-center aspect-square w-full flex-[0_0_calc(100%-4rem)] sm:flex-[0_0_calc(50%-2rem)] md:flex-[0_0_calc(33.333%-0.5rem)] overflow-hidden cursor-pointer service rounded-sm"
          >
            <img
              src={service.image}
              alt={service.name}
              loading="lazy"
              class="absolute inset-0 w-full h-full object-cover"
            />
            <Heading
              level={4}
              className="text-white text-center z-10 uppercase font-medium text-shadow-2xs"
              text={service.name}
            />
            <div class="translate-y-16 group-hover:translate-y-0 transition-transform duration-500 absolute bottom-4 left-1/2 -translate-x-1/2 z-10 flex items-center gap-1">
              <Heading
                level={5}
                className="text-white font-medium"
                text={"Ver más"}
              />
              <ArrowRight class="text-white size-4" />
            </div>
          </a>
        ))
      }
    </div>
  </section>
  <section class="w-full py-20 flex flex-col gap-20 relative overflow-hidden">
    <img
      src="/why-femcare.webp"
      alt="Why Hi Fem Care"
      class="absolute w-full h-full object-cover object-top z-[-1] parallax-image-2"
    />
    <Heading
      level={2}
      className="text-white text-shadow-sm font-medium text-balance text-xl sm:text-center "
      text="¿Por qué Hi Fem Care es tu mejor opción?"
    />
    <div
      class="grid md:grid-cols-3 grid-cols-1 grid-rows-[auto_1fr] gap-x-6 gap-y-3 max-w-6xl mx-auto"
    >
      {
        [
          {
            title: "Medicina moderna que realmente funciona.",
            description: [
              "No tratamos síntomas.",
              "Tratamos causas.",
              'En Hi Fem Care no damos “soluciones rápidas".',
              "Te escuchamos, entendemos tu historial y trabajamos desde el origen del problema: hormonal, funcional o emocional.",
              "Nuestro objetivo es ayudarte a recuperar tu equilibrio de forma real y sostenible.",
            ],
          },
          {
            title: "Médicos y especialistas que saben cómo cuidarte.",
            description: [
              "Nuestro equipo tiene décadas de experiencia en salud femenina, ginecología avanzada y regeneración íntima.",
              "Sabemos lo que tu cuerpo atraviesa y cómo acompañarte para que te sientas bien otra vez.",
            ],
          },
          {
            title: "Tecnología moderna, precisa y no invasiva.",
            description: [
              "Somos pioneros en Guatemala en el uso de tratamientos como MonaLisa Touch®, UltraClear® y Pelvicenter®.",
              "Tecnología diseñada para prevenir, regenerar y mejorar tu salud íntima sin dolor, sin cirugía y con resultados naturales.",
            ],
          },
        ].map((item, idx) => (
          <FadeIn
            duration={1}
            delay={idx * 0.1}
            class="grid grid-rows-subgrid row-span-2 border-4 border-black/10 bg-white rounded-md p-6 font-heading"
          >
            <Heading
              level={4}
              className="text-neutral-600 font-medium text-xl"
              text={item.title}
            />
            <div class="flex flex-col gap-2 text-brand-gray">
              {item.description.map((description) => (
                <p>{description}</p>
              ))}
            </div>
          </FadeIn>
        ))
      }
    </div>
  </section>
  <footer>
    <div
      class="w-full text-center bg-radial-[at_0%_75%] from-ziggurat relative overflow-hidden to-smokey-pink py-20 bg-grain"
    >
      <div
        class="max-w-7xl flex flex-col gap-4 items-center justify-center mx-auto z-20 relative"
      >
        <FadeIn duration={1}>
          <Heading
            level={2}
            className="text-white text-balance text-shadow-sm"
            text="No tienes que tener todas las respuestas. Solo necesitas el primer paso."
          />
        </FadeIn>
        <FadeIn duration={1} delay={0.1}>
          <p class="text-white sm:text-lg font-body">
            Tu bienestar íntimo empieza cuando te sientes acompañada. <br /> Agenda
            tu cita y da el primer paso hacia tu mejor versión.
          </p>
        </FadeIn>
        <FadeIn duration={1} delay={0.2}>
          <button
            class="bg-white text-ziggurat rounded-full py-2 uppercase font-heading px-6 group relative overflow-hidden cursor-pointer"
          >
            <span class="invisible">¡Agenda tu cita ahora!</span>
            <!-- Revealed text -->
            <span
              class="absolute inset-0 flex items-center justify-center -translate-y-full group-hover:translate-y-0 transition-transform duration-300 text-smokey-pink"
            >
              ¡Agenda tu cita ahora!
            </span>
            <!-- Initial text -->
            <span
              class="absolute inset-0 flex items-center justify-center translate-y-0 group-hover:translate-y-full transition-transform duration-300"
            >
              ¡Agenda tu cita ahora!
            </span>
          </button>
        </FadeIn>
      </div>
    </div>
    <div class="w-full text-center bg-white py-10">
      <div
        class="max-w-7xl flex flex-col gap-4 items-center justify-center mx-auto"
      >
        <Heading
          level={6}
          className="text-brand-gray font-medium text-xl"
          text="Horario de atención"
        />
        {
          [
            {
              day: "Lunes",
              start: "7:00 am",
              end: "4:00 pm",
            },
            {
              day: "Martes a Jueves",
              start: "6:30 am",
              end: "3:30 pm",
            },
            {
              day: "Viernes",
              start: "6:30 am",
              end: "2:30 pm",
            },
            {
              day: "Sábado",
              start: "7:00 am",
              end: "12:00 pm",
            },
          ].map((schedule) => (
            <div class="flex items-center flex-col font-heading text-brand-gray border-b border-brand-gray/20 pb-2">
              <span class="font-semibold">{schedule.day}</span>
              <span class="font-light">
                {schedule.start} - {schedule.end}
              </span>
            </div>
          ))
        }
        <p class="text-brand-gray font-heading font-light">
          Avenida La Reforma 9-55, Edif. Reforma 10 <br /> Zona 10, 6to. nivel, Clínica
          606,<br />
          Ciudad de Guatemala, Guatemala
        </p>
      </div>
    </div>
    <div
      class="w-full text-center bg-radial-[at_0%_75%] from-smokey-pink relative overflow-hidden to-ziggurat py-20 bg-grain"
    >
      <div
        class="max-w-7xl flex sm:flex-row flex-col gap-16 items-center justify-center mx-auto z-20 relative"
      >
        <img
          src="/logo-white.svg"
          alt="Hi Fem Care"
          class="object-contain w-56 h-auto"
        />
        <p class="text-white font-heading font-light">
          HI Fem Care forma parte de A Tu Origen, Sociedad Anónima. © {
            new Date().getFullYear()
          }. Todos los derechos reservados
        </p>
      </div>
    </div>
  </footer>
</RootLayout>

<style>
  /* Local variables */
  :root {
    --grain-texture: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 600'%3E%3Cfilter id='a'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23a)'/%3E%3C/svg%3E");
    --brand-gradient: linear-gradient(
      to top right,
      var(--color-ziggurat),
      var(--color-smokey-pink)
    );
  }

  /* Hero image parallax optimization */
  .image {
    will-change: transform;
    backface-visibility: hidden;
  }

  /* Service card grid */
  .service-grid {
    transition: opacity 0.7s var(--spring-easing);
  }

  @media (width > 768px) {
    .service-grid:hover .service {
      opacity: 0.8;
      scale: 0.975;
    }
  }

  .service-grid .service:hover {
    opacity: 1;
    scale: 1;
    z-index: 3;
  }

  .service {
    transition:
      opacity var(--spring-duration) var(--spring-easing),
      scale 0.7s var(--spring-easing);
  }

  .service::before,
  .service::after {
    content: "";
    position: absolute;
    inset: 0;
  }

  .service::before {
    background: var(--brand-gradient);
    transform: scaleY(0);
    transform-origin: bottom;
    transition: transform var(--spring-duration) var(--spring-easing);
    z-index: 2;
  }

  .service:hover::before {
    transform: scaleY(1);
    transform-origin: top;
  }

  .service::after {
    background: linear-gradient(
      to top right,
      oklch(from var(--color-ziggurat) l c h / 0.65),
      oklch(from var(--color-smokey-pink) l c h / 0.65)
    );
    mix-blend-mode: multiply;
    z-index: 1;
  }

  /* Grain textures */
  .bg-grain::before,
  .bg-grain-hero {
    background-image: var(--grain-texture);
    background-repeat: repeat;
    background-size: 200px;
  }

  .bg-grain::before {
    content: "";
    position: absolute;
    inset: 0;
    opacity: 0.35;
    z-index: 1;
  }

  .bg-grain-hero {
    mix-blend-mode: overlay;
    opacity: 0.7;
    pointer-events: none;
  }

  .bg-gradient-hero {
    background: linear-gradient(
      to top right,
      oklch(from var(--color-ziggurat) l c h / 0.7),
      oklch(from var(--color-smokey-pink) l c h / 0.7)
    );
    mix-blend-mode: multiply;
    pointer-events: none;
  }
</style>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);

  // reveal mask, clip path left to right
  gsap.to(".reveal-mask", {
    clipPath: "inset(0 100% 0 0)",
    duration: 1.1,
    ease: "power2.out",
  });

  gsap.to(".reveal-mask-2", {
    clipPath: "inset(0 100% 0 0)",
    duration: 1.34, // shorter = catches up
    delay: 0.175,
    ease: "power3.out", // snappier = more energy
  });

  // Hero image parallax - using force3D for GPU acceleration
  gsap.to(".parallax-image", {
    yPercent: -15,
    ease: "none",
    force3D: true,
    scrollTrigger: {
      trigger: ".thingy",
      start: "top top",
      end: "bottom top",
      scrub: 0.5, // slight smoothing reduces jank
    },
  });

  gsap.to(".parallax-image-2", {
    yPercent: -15,
    ease: "none",
    force3D: true,
    scrollTrigger: {
      trigger: ".why-femcare",
      start: "top top",
      end: "bottom top",
      scrub: 0.5,
    },
  });
</script>
